<!DOCTYPE html>
<html>
  <head>
    <title>API Practice</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="icon" href="http://icons.iconarchive.com/icons/graphicloads/polygon/256/traffic-signal-icon.png">
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css'>
  </head>
<body onload="loadPhotos();">
  <div class = "container">
    <div class = "jumbotron">
        <h1>API Practice</h1>
    </div>
    <div class="row">
      <div class="col-md-12" id="photos">
        loading photos...
      </div>
    </div>
    <!-- AIzaSyBihlB7C_yawFAQTCzUwfqEB6YLxxda7nY -->
    <footer>Alexander Neumann @ Epicodus 2018</footer>
  </div>
  CORS practice from CORS in ACTION
  <script>
  function loadPhotos(){
    var api_key = "";

    var method = 'GET';
    var url = 'https://api.flickr.com/services/rest/?' +
      'method=flickr.people.getPublicPhotos&' +
      'user_id=32951986%40N05&' +
      'extras=url_q&format=json&nojsoncallback=1&' +
      'api_key=' + api_key;
      console.log(url);
    var xhr = new XMLHttpRequest();
    if(!('withCredentials' in xhr)) {
      console.log("Browser does not support CORS");
      alert('Browser does not support CORS.');
      return;
    }
    xhr.open(method, url);

    xhr.oneerror = function() {
      console.log("oneerror");
      alert('There was an error.');
    };
    xhr.onload = function () {
      var data = JSON.parse(xhr.responseText);
      console.log(data);
      if(data.stat == 'ok') {
        console.log("data.stat = ok");
        var photosDiv = document.getElementById('photos');
        photosDiv.innerHTML = '';
        var photos = data.photos.photo;
        for(var i = 0; i < photos.length; i++){
          var img = document.createElement('img');
          img.src = photos[i].url_q;
          photosDiv.appendChild(img);

        }
      } else {
        alert(data.message);
      }
    };
    xhr.send();
  }
  </script>
</body>
